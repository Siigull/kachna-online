<h1>Přehled úklidů</h1>

<app-year-selection (yearChange)="this.yearChanged($event)"
                     [justifyCenter]="false"></app-year-selection>

<div class="d-flex align-items-center">
  <span class="dot bg-success"></span>
  <span class="mr-4">Archiv úklidů</span>
</div>

<table class="table table-stripped" *ngIf="cleanings.length > 0">
  <thead class="thead-light">
  <tr>
    <th>Jméno</th>
    <th>Začátek</th>
    <th>Konec</th>
    <th>Místo</th>
    <th>Dokončen</th>
    <th *ngIf="authenticationService.isCleaningsManager()">Operace</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let cleaningDetail of cleanings" class="clickable"
    [ngClass]="{
    'table-secondary': cleaningDetail.to.getTime() < now.getTime(),
    'table-success': cleaningDetail.from.getTime() < now.getTime() && cleaningDetail.to.getTime() >= now.getTime()
    }"
  >

  <td (click)="openCleaningDetail(cleaningDetail)">{{cleaningDetail.name}}</td>
    <td (click)="openCleaningDetail(cleaningDetail)">
      {{cleaningDetail.from | date:'d. M. yyyy HH:mm'}}
    </td>
    <td (click)="openCleaningDetail(cleaningDetail)">
      {{cleaningDetail.to | date:'d. M. yyyy HH:mm'}}
    </td>
    <td (click)="openCleaningDetail(cleaningDetail)">
      {{cleaningDetail.place}}
    </td>
    <td (click)="openCleaningDetail(cleaningDetail)">
      <span *ngIf="cleaningDetail.finished">
        <i class="fas fa-check"></i>
        Ano
      </span>
      <div *ngIf="!cleaningDetail.finished">
        <span *ngIf="cleaningDetail.to.getTime() < now.getTime()">
          <i class="fas fa-exclamation"></i>
          Ne
        </span>
        <span *ngIf="cleaningDetail.to.getTime() >= now.getTime()">
          <i class="fas fa-times"></i>
          Ne
        </span>
      </div>
    </td>
    <td *ngIf="authenticationService.isCleaningsManager()">
      <div class="row" *ngIf="cleaningDetail.to.getTime() > now.getTime()">
        <button type="button" class="btn mr-1 btn-primary float-right"
                data-toggle="modal" data-target="#exampleModal"
                data-backdrop="static" data-keyboard="false" (click)="onModifyButtonClicked(cleaningDetail)">
          <i class="far fa-edit"></i>
          Upravit
        </button>
        <button type="button" class="btn btn-danger" (click)="onDeleteButtonClicked(cleaningDetail)">
          <i class="far fa-trash-alt"></i>
          Odstranit
        </button>
      </div>
    </td>
  </tr>
  </tbody>
</table>

<div *ngIf="cleanings.length == 0" class="mb-5 d-flex justify-content-center">
  <h5 class="text-secondary ">Tento rok se zatím nekonají žádné úklidy.</h5>
</div>
